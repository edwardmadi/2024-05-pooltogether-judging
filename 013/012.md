Creamy Ginger Salamander

high

# Malicious user can take advantage of auto-accruing WETH in the PrizePool contract on blast to unfairly increase winning odds

## Summary
Malicious user can take advantage of auto-accruing WETH in the PrizePool contract on blast to unfairly increase winning odds

## Vulnerability Detail
The protocol has clearly stated they plan on deploying to Blast

They also state the following
>We're interested to know if there will be any issues deploying the code as-is to any of these chains

On blast, smart contracts holding WETH have Automatic yield by default. It is auto-accruing, so over time the WETH balance of the contract will increase as yield comes in.

A user can take advantage of this by calling `PrizePool.contributePrizeTokens()` once the yield enters the contract, passing in their vault and the exact amount of blast WETH yield that just entered the contract.

```solidity
function contributePrizeTokens(address _prizeVault, uint256 _amount) public returns (uint256) {
    uint256 _deltaBalance = prizeToken.balanceOf(address(this)) - accountedBalance();
    if (_deltaBalance < _amount) {
      revert ContributionGTDeltaBalance(_amount, _deltaBalance);
    }
    uint24 openDrawId_ = getOpenDrawId();
    _vaultAccumulator[_prizeVault].add(_amount, openDrawId_);
    _totalAccumulator.add(_amount, openDrawId_);
    emit ContributePrizeTokens(_prizeVault, openDrawId_, _amount);
    return _deltaBalance;
  }
```

Once the yield enter the contract the `prizeToken.balanceOf(address(this))` will increase, therefore `_deltaBalance ` will increase too. All an attacker has to do is wait for the yield, pre compute the `_deltaBalance ` and then call `contributePrizeTokens` passing the calculated `_deltaBalance ` as the `_amount` parameter

This is unfair because the WETH balance of the PrizePool contract is generated by all the users of the protocol. Hence the blast yield on that WETH should be distributed equitably, not to a single user.

## Impact
A malicious user has unfairly increased their odds of winning at 0 cost at the expense of all other protocol users.

## Code Snippet
https://github.com/sherlock-audit/2024-05-pooltogether/blob/1aa1b8c028b659585e4c7a6b9b652fb075f86db3/pt-v5-prize-pool/src/PrizePool.sol#L412-L422

## Tool used

Manual Review

## Recommendation
Implement a system so the blast yield is distributed in a fair way
